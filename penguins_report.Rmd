---
title: Sexual Dimorphism of Penguins
author: 
- name: Duygu Nur Arabaci
  affiliation: Department of Bioinformatics, University of Potsdam, Germany
- name: Mekontso Tepeu Florentin Jose
  affiliation: Department of Bioinformatics, University of Potsdam, Germany
bibliography: [penguins_refs.bib, packages.bib]

nocite: '@*'

output:
  bookdown::html_document2:
  number_sections: TRUE
  fig_caption: TRUE
  toc: true
  toc_depth: 2

---

```{r include=FALSE}
knitr::opts_chunk$set(echo=FALSE, warning=FALSE, message = FALSE, tidy = TRUE)
```

```{r label=loading,results="hide"}
# Packages
packages <- c("palmerpenguins", "ggplot2", "knitr", "tidyverse", "lsr", "bookdown")

# Install packages not yet installed
installed_packages <- packages %in% rownames(installed.packages())
if (any(installed_packages == FALSE)) {
  install.packages(packages[!installed_packages])
}

# Packages loading
invisible(lapply(packages, library, character.only = TRUE))

source("arabaci2_lipsum.R")

#Create citations for packages used
knitr::write_bib(c(.packages(), packages), "packages.bib")
```

# Abstract

<div id="abstract">
`r lipsum(2,paragraphs=1, lang="english")`
</div>
<br>

# Introduction

`r lipsum(1,paragraphs=1, lang="english")`

# Data and Methods

## General information about Palmer Penguins data
```{r}
penguins=as.data.frame(penguins)
#number of penguins
total_pengs=length(penguins$species)
pengs = penguins %>% count(species)
adelies = pengs[1,2]
chinstraps = pengs[2,2]
gentoos = pengs[3,2]

tab = table(penguins$species, penguins$island)
```

```{r tab}
knitr::kable(tab,caption = "The number of penguin species on the three islands.", "pipe", align = "ccc")
```
`
```{r}
#On Gentoos
Gentoo=penguins[penguins$species=="Gentoo",]

male=Gentoo[Gentoo$sex=="male",]
female=Gentoo[Gentoo$sex=="female",]
#Gentoo number of males and females

```
```{r}
#to clean up data and replace NAs with mean values, WIP
mean_bill_depth = as.double(round(mean(Gentoo$bill_depth_mm, na.rm = TRUE)))
```

The total number of penguins was `r total_pengs`. A total of `r adelies`, `r gentoos`, `r chinstraps` penguins of species Adelie, Gentoo and Chinstraps were included respectively.

```{r}
#Defining color variables here so that they are consistent and can be changed easily later on
color_f = "violet"
color_m  = "steelblue2"
```

```{r, fig.cap="Measurements for Gentoo males and females"}
ggplot(Gentoo, aes(x =bill_depth_mm  , y = bill_length_mm , color = sex))+
  geom_point() +
  labs(
    #title = "Bill depth and length",
    #subtitle = "Measurements for Gentoo males and females",
    x = "Bill depth (mm)", y = "Bill length(mm)",
    legend = "Sex",
  ) +
  scale_color_manual(values=c(color_f,color_m))

```

```{r}
cWeight=cut(Gentoo$body_mass_g,breaks=quantile(Gentoo$body_mass_g,c(0,1/3,2/3,1),na.rm=TRUE),include.lowest=TRUE)
levels(cWeight)=c("Light","Medium","Heavy")
weight_cat = table(cWeight, Gentoo$sex)
colnames(weight_cat) = c("Female", "Male")
```
```{r}
knitr::kable(weight_cat, caption = "Number of Gentoos in each weight category", "pipe", align = "ccc") 
```

```{r fig.width=7,fig.height=5, fig.cap="Body Mass of Males and Females"}
layout(matrix(c(1,2,3,3), ncol=2, byrow=TRUE), heights=c(4, 1))

with(Gentoo,boxplot(Gentoo$body_mass_g ~ sex,col=c(color_f, color_m), ylab="Body Mass (in g)"))
barplot(t(weight_cat),xlab="Weight Categories", ylab = "Number of Penguins", col=c(color_f, color_m))

par(mai=c(0,0,0,0))
plot.new()
legend(x="center", ncol=2,legend=c("Male","Female"),
       fill=c(color_m, color_f), title="Penguins body weight by sex")
```

# Statistical Analysis

```{r}
#check if data is normally distributed
par(mfrow = c(2,2))
hist(male$bill_length_mm)
hist(female$bill_length_mm)
hist(male$bill_depth_mm)
hist(female$bill_depth_mm)

```
```{r}
bl_m = shapiro.test(male$bill_length_mm)
bl_f = shapiro.test(female$bill_length_mm)
bd_m = shapiro.test(male$bill_depth_mm)
bd_f = shapiro.test(female$bill_depth_mm)
#(p<0.05 means not normally distributed)
s_ps = round(c(bl_m$p.value, bl_f$p.value, bd_m$p.value, bd_f$p.value), digits = 2)

```
Shapiro-Wilk normality test was performed on male and female bill length and bill depth data. The p values for bill length distributions for males and females respectively were `r s_ps[1]` and `r s_ps[2]` respectively; and the p values for bill depth distributions for males and females were `r s_ps[3]` and `r s_ps[4]`, respectively. 
Shapiro-Wilk normality tests for combined bill depth and bill length have shown p values of `r round(shapiro.test(Gentoo$bill_depth_mm)$p.value, digits=2)` and `r round(shapiro.test(Gentoo$bill_length_mm)$p.value, digits=2)`, both less than 0.05, suggesting non-normal distribution.

# Results

`r lipsum(2,paragraphs=1)`

# Discussion

`r lipsum(2,paragraphs=1)`

# Acknowledgment

`r lipsum(2,paragraphs=1)`

# Bibliography

<div id="refs"></div>

# Appendix

